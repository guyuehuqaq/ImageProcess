# 1、尺度不变特征转换
SIFT 是 David Lowe 提出的经典局部特征算法，核心思想是提取尺度不变、旋转不变的关键点，
并为每个关键点生成稳定描述子。
# SIFT 算法流程

## 1️⃣ 构建尺度空间 (Scale-space)

**目标**：检测图像在不同尺度下的极值点，以保证特征对尺度变化不敏感。

**方法**：

- 对图像进行高斯模糊：

L(x, y, σ) = G(x, y, σ) * I(x, y)

其中 G 是高斯核，σ 是尺度。

- 构建高斯金字塔 (Gaussian Pyramid)：
    - 每个 Octave：图像分辨率下采样一半。
    - 每个 Octave 中生成若干 blurred 图像，尺度不断增大。

- 生成高斯差分金字塔 (DoG, Difference of Gaussian)：

D(x, y, σ) = L(x, y, kσ) - L(x, y, σ)

用于近似尺度空间的拉普拉斯算子，便于寻找极值点。

---

## 2️⃣ 尺度空间极值点检测

**目标**：在尺度空间中找到潜在关键点（尺度不变关键点）。

**方法**：

- 遍历 DoG 金字塔的每个像素点 D(x, y, σ)。
- 与同一尺度和相邻尺度的 26 个邻居比较（3×3×3 立方体）。
- 如果该点是局部最大值或最小值，则作为候选关键点。

---

## 3️⃣ 精确关键点定位

**目标**：精确确定关键点位置，并剔除不稳定的点。

**方法**：

- 利用泰勒展开在尺度空间中对极值点精确拟合。
- 计算关键点偏移量：

x_hat = - H^-1 * ∇D

其中 H 是 Hessian 矩阵。
- 剔除低对比度点（对比度 < 阈值）和边缘响应点（通过 Hessian 特征值比值判断）。

---

## 4️⃣ 方向分配 (Orientation Assignment)

**目标**：使关键点旋转不变。

**方法**：

- 在关键点邻域内计算梯度幅值和方向：

m(x, y) = sqrt( (L(x+1, y) - L(x-1, y))^2 + (L(x, y+1) - L(x, y-1))^2 )

θ(x, y) = arctan( (L(x, y+1) - L(x, y-1)) / (L(x+1, y) - L(x-1, y)) )

- 用方向直方图（通常 36 个 bins，10°/bin）统计邻域梯度方向。
- 取峰值方向作为关键点的主方向，多峰值可产生多个关键点。

---

## 5️⃣ 关键点描述子生成 (Descriptor)

**目标**：为每个关键点生成对旋转、光照、微小变形不敏感的描述子。

**方法**：

- 以关键点为中心，旋转到主方向坐标系。
- 将邻域划分为 4×4 个子区域，每个子区域计算梯度方向直方图（8 bins）。
- 将每个子区域直方图连接，形成 128 维向量（4×4×8）。
- 归一化向量，并限制最大值（>0.2）再归一化，提高光照鲁棒性。

---

## 6️⃣ 特征匹配

**目标**：使用描述子进行图像间匹配。

**方法**：

- 使用欧氏距离或余弦相似度计算特征点间的距离。
- 常用比值测试 (Lowe ratio) 剔除歧义匹配：

distance_ratio = d1 / d2 < 0.8

其中 d1 和 d2 分别是最近和次近邻距离。
